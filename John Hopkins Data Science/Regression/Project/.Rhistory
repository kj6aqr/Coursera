require(datasets)
dataset(swiss)
require(datasets)
data("InsectSprays")
require(stats)
g=ggplot(data=InsectSprays,aes(y=count,x=spray,fill=spray))
require(ggplot2)
g=ggplot(data=InsectSprays,aes(y=count,x=spray,fill=spray))
g=g+geom_violin(colour="black",size=2)
g=g+xlab("Type of Spray")+ylab("Insect count")
g
summary(lm(count~spray,data=InsectSprays))$coef
summary(lm(count~I(1*spray=='B'))+I(1*spray=='C'))+I(1*spray=='D'))+I(1*spray=='E'))+I(1*spray=='F'))+)
summary(lm(count~I(1*spray=='B'))+I(1*spray=='C'))+I(1*spray=='D'))+I(1*spray=='E'))+I(1*spray=='F'))
summary(lm(count~I(1*spray=='B'))+I(1*spray=='C'))+I(1*spray=='D'))+I(1*spray=='E'))+I(1*spray=='F')))
summary(lm(count~I(1*spray=='B'))+I(1*spray=='C'))+I(1*spray=='D'))+I(1*spray=='E'))+I(1*spray=='F'))))
summary(lm(count~I(1*spray=='B')+I(1*spray=='C')+I(1*spray=='D'))+I(1*spray=='E')+I(1*spray=='F')),data=InsectSprays)
summary(lm(count~I(1*spray=='B')+I(1*spray=='C')+I(1*spray=='D')+I(1*spray=='E')+I(1*spray=='F')),data=InsectSprays)
summary(lm(count~I(1*(spray=='B'))+I(1*(spray=='C'))+I(1*(spray=='D'))+I(1*(spray=='E'))+I(1*(spray=='F')),data=InsectSprays)
)
setwd("/Users/aqua/Documents/Coursera/Regression/Project")
require(mtcars)
download.packages(datasets)
download.packages("datasets")
download.packages("dataset")
install.packages("dataset")
install.packages("datasets")
data("mtcars")
require(dataset)
require("dataset")
require("datasets")
require(datasets)
lm(mpg~gear,data=mtcars)
?mtcars
lm(mpg ~ am,data=mtcars)
lm(mpg ~ .,data=mtcars)
plot(mpg ~ am,data=mtcars)
plot(mpg ~ factor(am),data=mtcars)
plot(hp ~ factor(am),data=mtcars)
plot(qsec ~ factor(am),data=mtcars)
plot(cyl ~ factor(am),data=mtcars)
plot(factor(cyl) ~ factor(am),data=mtcars)
plot(factor(carb) ~ factor(am),data=mtcars)
plot(disp ~ factor(am),data=mtcars)
fit1<-lm(hp~factor(am),data=mtcars)
fit2<-lm(hp~factor(am)+hp,data=mtcars)
fit2<-lm(hp ~ factor(am)+hp, data=mtcars)
fit2<-lm(hp ~ factor(am), data=mtcars)
fit2<-lm(hp ~ factor(am) + qsec, data=mtcars)
fit2<-lm(hp ~ factor(am) + hp, data=mtcars)
fit2<-lm(hp ~ factor(am) + mtcars$hp, data=mtcars)
fit3<-lm(hp ~ factor(am) + mtcars$hp + mtcars$disp, data=mtcars)
fit4<-lm(hp ~ factor(am) + mtcars$hp + mtcars$disp + factor(cyl), data=mtcars)
fit5<-lm(hp ~ factor(am) + mtcars$hp + mtcars$disp + factor(carb), data=mtcars)
anova(fit1,fit2,fit3,fit4,fit5)
fit2<-lm(mpg ~ factor(am) + mtcars$hp, data=mtcars)
fit1<-lm(mpg ~ factor(am), data=mtcars)
fit3<-lm(mpg ~ factor(am) + mtcars$hp + mtcars$disp, data=mtcars)
fit4<-lm(mpg ~ factor(am) + mtcars$hp + mtcars$disp + factor(cyl), data=mtcars)
fit5<-lm(mpg ~ factor(am) + mtcars$hp + mtcars$disp + factor(carb), data=mtcars)
anova(fit1,fit2,fit3,fit4,fit5)
fit2<-lm(mpg ~ factor(am) + mtcars$disp, data=mtcars)
anova(fit1,fit2,fit3,fit4,fit5)
plot(qsec~factor(am),data=mtcars)
plot(wt~factor(am),data=mtcars)
plot(wt~hp,data=mtcars)
lm(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
summary(lm(wt~hp,data=mtcars))
summary(lm(wt~hp,data=mtcars))$r.squared
lm(mpg~wt+hp)
lm(mpg~wt+hp,data=mtcars)
plot(mpg~wt+hp,data=mtcars)
plot(mpg~wt+hp,data=mtcars)
fit6<-lm(mpg ~ factor(am) + hp, data=mtcars)
fit7<-lm(mpg ~ factor(am) + hp + qsec, data=mtcars)
anova(fit6,fit7)
fit8<-lm(mpg ~ factor(am) + hp + qsec + wt, data=mtcars)
anova(fit6,fit7,fit8)
fit9<-lm(mpg ~ factor(am) + hp + wt)
fit9<-lm(mpg ~ factor(am) + hp + wt,data=mtcars)
anova(fit6,fit9,fit8)
plot(factor(gear)~factor(am),data=mtcars)
lm(factor(gear)~factor(am),data=mtcars)
summarylm(factor(gear)~factor(am),data=mtcars)$r.squared
summary(lm(factor(gear)~factor(am),data=mtcars)$r.squared
)
summary(lm(factor(gear)~factor(am),data=mtcars))$r.squared
fit<-lm(mpg ~ factor(am) + hp + wt, data=mtcars)
summary(fit)$coef
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(20,labels=summary(lm(wt~hp,data=mtcars))$r.squared)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(200,labels=summary(lm(wt~hp,data=mtcars))$r.squared)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=100,labels=summary(lm(wt~hp,data=mtcars))$r.squared)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=1,y=1,labels=summary(lm(wt~hp,data=mtcars))$r.squared)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=1,y=1,labels=summary(lm(wt~hp,data=mtcars))$r.squared)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=summary(lm(wt~hp,data=mtcars))$r.squared)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=round(summary(lm(wt~hp,data=mtcars))$r.squared),3)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=round(summary(lm(wt~hp,data=mtcars))$r.squared),5)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=round(summary(lm(wt~hp,data=mtcars))$r.squared),1)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=round(summary(lm(wt~hp,data=mtcars))$r.squared))
?round
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=round(summary(lm(wt~hp,data=mtcars))$r.squared),digits=4)
summary(lm(wt~hp,data=mtcars))$r.squared
round(summary(lm(wt~hp,data=mtcars))$r.squared,2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=round(summary(lm(wt~hp,data=mtcars))$r.squared),2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=round(summary(lm(wt~hp,data=mtcars))$r.squared))
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=(summary(lm(wt~hp,data=mtcars))$r.squared))
txt<-round(summary(lm(wt~hp,data=mtcars))$r.squared,2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
text(x=100,y=4,labels=txt)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-round(summary(lm(wt~hp,data=mtcars))$r.squared,3)
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-paste("r2 = ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-paste("r2 = ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-paste("r2 = ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-paste("r^2 = ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-paste("$r^2$ = ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-paste("$r^2$ = ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-parse(paste("$r^2$ = ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3)))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-parse(paste("r^2 = ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3)))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-parse(text=paste("r^2 = ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3)))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-parse(text=paste("r^2 \= ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3)))
text(x=100,y=5,labels=r2)
?parse
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-parse(text=paste("r^2 == ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3)))
text(x=100,y=5,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-parse(text=paste("r^2 == ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3)))
text(x=200,y=4,labels=r2)
plot(wt~hp,data=mtcars)
abline(lm(wt~hp,data=mtcars))
r2<-parse(text=paste("r^2 == ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3)))
text(x=220,y=4.5,labels=r2)
require(ggplot2)
install.packages(kfigr)
install.packages("kfigr")
?kfigr
pin(2)
plot(mpg~factor(am),data=mtcars,xlab="Transmission type",ylab="Gas mileage")
pin(2)
plot(mpg~factor(am),data=mtcars,xlab="Transmission type",ylab="Gas mileage")
par(pin=2)
plot(mpg~factor(am),data=mtcars,xlab="Transmission type",ylab="Gas mileage")
par(pin=c(2,2)
plot(mpg~factor(am),data=mtcars,xlab="Transmission type",ylab="Gas mileage")
par(pin=c(2,2))
plot(mpg~factor(am),data=mtcars,xlab="Transmission type",ylab="Gas mileage")
amf=factor(am,levels=1:2,labels=c("Automatic","Manual"))
mtcars$amf=factor(mtcars$am,levels=1:2,labels=c("Automatic","Manual"))
mtcars$amf=factor(mtcars$am,levels=0:1,labels=c("Automatic","Manual"))
?mtcars
resid(fit)
plot(mtcars$mpg,resid(fit))
hatvalues(fit)
resid(fit)/((1-hatvalues(fit)))
resid(fit)
plot(fit)
fit
plot(fit)[1]
plot(fit)
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)")
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
legend('topright',legend=levels(mtcars$amf),col=1:2)
legend('topright',legend=levels(mtcars$amf),col=1:2,cex = 0.8, pch=1)
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
abline(lm(wt~hp,data=mtcars))
legend('topright',legend=levels(mtcars$amf),col=1:2,cex = 0.8, pch=1)
r2<-parse(text=paste("r^2 == ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3)))
text(x=220,y=4.5,labels=r2)
x <- rep(1:10,2)
y <- rnorm(20,rep(1:2,each)*x)
g <- gl(2,10)
xyplot(y~x,groups=g,
panel=panel.superpose, panel.groups=function(x,y,...){
tmp.lm<-lm(y~x)
panel.abline(tmp.lm)
panel.text(2, coef(tmp.lm)%*%c(1,2),
label=format(tmp.lm$coefficients[2], digits=4), pos=4)
panel.xyplot(x,y,...)
})
x <- rep(1:10,2)
y <- rnorm(20,rep(1:2,each)*x)
g <- gl(2,10)
plot(y~x,groups=g,
panel=panel.superpose, panel.groups=function(x,y,...){
tmp.lm<-lm(y~x)
panel.abline(tmp.lm)
panel.text(2, coef(tmp.lm)%*%c(1,2),
label=format(tmp.lm$coefficients[2], digits=4), pos=4)
panel.xyplot(x,y,...)
})
?xyplot
??xyplot
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
abline(lm(wt[am==0,]~hp[am==1,],data=mtcars))abline(lm(wt[am==0,]~hp[am==1,],data=mtcars))
legend('topright',legend=levels(mtcars$amf),col=1:2,cex = 0.8, pch=1)
r2<-parse(text=paste("r^2 == ",round(summary(lm(wt~hp,data=mtcars))$r.squared,3)))
text(x=220,y=4.5,labels=r2)
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
abline(lm(wt[am==0,]~hp[am==1,],data=mtcars))abline(lm(wt[am==0,]~hp[am==1,],data=mtcars))
legend('topright',legend=levels(mtcars$amf),col=1:2,cex = 0.8, pch=1)
text(x=220,y=4.5,labels=r2)
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
abline(lm(wt[am==0,]~hp[am==1,],data=mtcars))
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
abline(lm(mtcars$mpg[mtcars$am==1]~mtcars$hp[mtcars$am==1]))
abline(lm(mtcars$mpg[mtcars$am==0]~mtcars$hp[mtcars$am==0]))
abline(lm(mpg~wt),data=mtcars)
abline(lm(wt~hp),data=mtcars)
abline(lm(wt~hp),data=mtcars))
abline(lm(wt~hp,data=mtcars))
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
abline(lm(mtcars$wt~mtcars$hp))
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
abline(lm(mtcars$wt[$am==1]~mtcars$hp[mtcars$am==1]))
abline(lm(mtcars$wt[mtcars$am==1]~mtcars$hp[mtcars$am==1]))
abline(lm(mtcars$wt[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col="read")
abline(lm(mtcars$wt[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col="red")
abline(lm(mtcars$wt[mtcars$am==0]~mtcars$hp[mtcars$am==0]),col="black")
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
abline(lm(mtcars$wt[mtcars$am==0]~mtcars$hp[mtcars$am==0]),col=mtcars$am)
abline(lm(mtcars$wt[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col=mtcars$am)
abline(lm(mtcars$wt[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col=1)
plot(wt~hp,data=mtcars,ylab="Vehicle weight (1000 lb)",xlab="Engine output (hp)",col=amf)
abline(lm(mtcars$wt[mtcars$am==0]~mtcars$hp[mtcars$am==0]),col="black")
abline(lm(mtcars$wt[mtcars$am==1]~mtcars$hp[mtcars$am==1]),col="red")
legend('bottomright',legend=levels(mtcars$amf),col=1:2,cex = 0.8, pch=1)
